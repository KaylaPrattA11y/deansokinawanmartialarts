---
import type { Post } from "../../types";

const { post, isStub = false } = Astro.props as { post: Post, isStub?: boolean };
---

<header class="post-meta">
  <time datetime={post.data.pubDate.toISOString()}>
    {
      new Date(post.data.pubDate).toLocaleDateString("en-US", {
        year: "numeric",
        month: "long",
        day: "numeric",
      })
    }
  </time>
  {isStub ? (
    <>
      <h2>{post.data.title}</h2>
      <p class="desc">{post.data.description}</p>
    </>
  ) : (
    <>
      <h1>{post.data.title}</h1>
      {post.data.author && <span class="author">By {post.data.author}</span>}
      <p class="lead">{post.data.description}</p>
    </>
  )}
  {
    post.data.tags && (
      <div class="tags">
        {post.data.tags.map((tag) => (
          <span class="tag">{tag}</span>
        ))}
      </div>
    )
  }
</header>

<style>
  @layer components {
    :is(h1, h2) {
      font-family: var(--ff-heading);
      font-weight: 700;
      color: var(--paper);
      margin-block: 0.5em;
      line-height: 1.2;
    }
    h1 {
      font-size: clamp(2rem, 5vw, 3rem);
    }
    h2 {
      font-size: 1.25rem;
    }
    time {
      font-family: var(--ff-heading);
      font-size: 1rem;
      letter-spacing: 0.4em;
      text-transform: uppercase;
      color: var(--silver);
      margin-bottom: 1rem;
    }
    .desc, .lead {
      line-height: 1.7;
      color: var(--cream);
      margin-bottom: 1.5rem;
    }
    .desc {
      font-size: 1rem;
      display: -webkit-box;
      -webkit-box-orient: vertical;
      -webkit-line-clamp: 5;
      overflow: hidden;
      @container (width >= 900px) {
        -webkit-line-clamp: 10;
      }
    }
    .lead {
      font-size: 1.35rem;
    }
    .tags {
      display: flex;
      gap: 0.5rem;
      flex-wrap: wrap;
      margin: 1rem 0;
    }
    .tag {
      font-family: var(--ff-heading);
      background: var(--stone);
      padding: 0.25rem 0.75rem;
      border-radius: 4px;
      font-size: 0.875rem;
    }
    .author {
      display: block;
      font-family: var(--ff-body);
      font-style: italic;
      font-size: 0.9rem;
      color: var(--cream);
      letter-spacing: 0.05em;
    }
  }
</style>
